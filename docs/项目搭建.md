## 搭建vite 项目

切换到存放项目的目录，例如：

```bash
cd Documents/project
```

查看 node 版本：

搭建项目前先确认 node 版本：**Vite 需要 [Node.js](https://nodejs.org/en/) 版本 20.19+, 22.12+，**建议使用 [nvm](https://nvm.uihtm.com/doc/guide.html) 管理node 版本

```bash
node -v
```

使用 20 版本 node：
![nvm](./images/nvm.png)

使用 vite 命令搭建项目

```bash
npm create vite@latest
```

回车后按照提示进行配置：
![image.png](./images/create-vite.png)

切换到项目目录：

```bash
cd vite-project
```

安装依赖：

```bash
npm i
```

启动项目：

```bash
npm run dev
```

![system](./images/system.png)

至此 vite + vue3 + TS 项目骨架已完成，接下来完善项目配置，集成：Vue Router、Vuex|pinia、Axios、Sass、EsLint、prettier、stylelint、editConfig、npmrc、tsconfig、lodash、autoImport、compress

## 完善目录结构

```bash
vite-project/
├── .cursor/                        // Cursor IDE 配置目录
├── .vscode/                       // VS Code 编辑器配置目录
├── dist/                          // 构建输出目录
├── node_modules/                  // npm 依赖包目录
├── docs/                          // 项目文档目录
├── public/                        // 公共静态资源目录
├── scripts/                       // 构建和部署脚本目录
├── patches/                       // 第三方库补丁文件
├── src/                          // 源代码目录
│   ├── api/                      // API 接口目录
│   ├── assets/                   // 静态资源目录
│   ├── components/               // 公共组件目录
│   ├── configs/                  // 配置文件目录
│   ├── directive/                // 自定义指令目录
│   ├── hooks/                    // Vue Hooks 目录
│   ├── mixins/                   // 混入文件目录
│   ├── plugins/                  // 插件配置目录
│   ├── router/                   // 路由配置目录
│   ├── static/                   // 静态配置目录
│   ├── store/                    // 状态管理目录
│   ├── types/                    // TypeScript 类型定义目录
│   ├── views/                    // 页面组件目录
│   ├── utils/                    // 工具函数目录
│   ├── App.vue                   // 根组件
│   ├── main.ts                   // 应用入口文件
│   └── permission.js             // 权限控制
├── typings/                      // 全局类型定义目录
├── vite-plugins/                 // Vite 插件目录
├── .cursorignore                 // Cursor IDE 忽略文件配置
├── .editorconfig                 // 编辑器统一配置
├── .eslint.config.js             // ESLint 代码质量检查配置
├── .gitignore                    // Git 忽略文件配置
├── .npmrc                        // npm 配置文件
├── .prettierrc                   // Prettier 代码格式化配置
├── .stylelintrc.js              // StyleLint CSS/SCSS 代码检查配置
├── index.html                  // 应用入口 HTML 文件
├── package.json                // 项目依赖和脚本配置
├── package-lock.json           // npm 依赖锁定文件
├── README.md                   // 项目说明文档
├── stats.html                  // 构建分析报告文件
├── tsconfig.json              // TypeScript 编译配置
├── tsconfig.node.json         // Node.js 环境 TypeScript 配置
└── vite.config.ts           // Vite 构建工具配置
```

## ESLint、prettier、stylelint、editorconfig 代码规范

### ESLint

[ESLint](https://eslint.org/) 是一款用于查找并报告代码中问题的工具，并且支持部分问题自动修复。其核心是通过对代码解析得到的 AST（Abstract Syntax Tree 抽象语法树）进行模式匹配，来分析代码达到检查代码质量和风格问题的能力。

1. 安装：

```bash
npm install eslint@8.28.0 -D
```

2. 配置

如果想要从头生成一份配置：执行 npx eslint --init，然后按照终端操作提示完成一系列设置来创建配置文件。
   ![eslint](./images/eslint.png)
   执行完成后会在根目录下生成 .eslint.config.js 文件
   [eslintConfig](./eslintConfig.md)
   注意，idea 的 settings 中需要配置保存自动格式化（和旧版不同）
   ```json
   "editor.formatOnSave": true,
   ```

旧版项目的配置和新版 eslint 配置不同，旧版配置：
   [eslintrc](../.eslintrc.cjs)

    > 新版ESLint 将配置文件从 .eslintrc.js 改为 .eslint.config.js 文件

3. ESLint 依赖插件安装与说明：

#### 核心ESLint包
```bash
# ESLint 核心包 - 提供代码质量检查的核心功能
npm install eslint -D
```

#### JavaScript/TypeScript 支持
```bash
# JavaScript 基础规则包 - 提供 JavaScript 核心 ESLint 规则
npm install @eslint/js -D

# TypeScript ESLint 插件 - 提供 TypeScript 特定的 ESLint 规则
npm install @typescript-eslint/eslint-plugin -D

# TypeScript 解析器 - 让 ESLint 能够解析 TypeScript 代码
npm install @typescript-eslint/parser -D
```

#### Vue.js 框架支持
```bash
# Vue.js ESLint 插件 - 提供 Vue.js 框架特定的 ESLint 规则和组件 API 排序
npm install eslint-plugin-vue -D
```

#### 代码格式化集成
```bash
# Prettier ESLint 插件 - 将 Prettier 格式化规则集成到 ESLint 中
npm install eslint-plugin-prettier -D

# Prettier ESLint 配置 - 关闭与 Prettier 冲突的 ESLint 规则
npm install eslint-config-prettier -D
```

#### 模块导入管理
```bash
# 导入语句管理插件 - 检查 ES6+ import/export 语法，防止导入不存在的模块
npm install eslint-plugin-import -D

# 导入语句自动排序插件 - 自动排序和格式化 import 语句
npm install eslint-plugin-simple-import-sort -D

# 导入路径别名解析器 - 支持路径别名（如 @ 指向 src）的模块解析
npm install eslint-import-resolver-alias -D

# TypeScript 导入解析器 - 支持 TypeScript 项目的模块路径解析
npm install eslint-import-resolver-typescript -D
```

#### 多文件类型支持
```bash
# JSON 文件 ESLint 支持 - 提供 JSON 文件的语法检查和格式化
npm install @eslint/json -D

# Markdown 文件 ESLint 支持 - 提供 Markdown 文件中代码块的语法检查
npm install @eslint/markdown -D

# CSS 文件 ESLint 支持 - 提供 CSS/SCSS 文件的语法检查和规则
npm install @eslint/css -D
```

#### 一键安装所有依赖
```bash
# 如果需要一次性安装所有 ESLint 相关依赖，可以使用以下命令：
npm install eslint@8.28.0 @eslint/js @eslint/json @eslint/markdown @eslint/css @typescript-eslint/eslint-plugin @typescript-eslint/parser eslint-plugin-vue eslint-plugin-prettier eslint-config-prettier eslint-plugin-import eslint-plugin-simple-import-sort eslint-import-resolver-alias eslint-import-resolver-typescript -D
```

#### 编辑器插件
vscode 需要安装 eslint 插件：![eslint](./images/eslint-vscode.png)

> **插件功能总结：**
> - **核心功能**：ESLint 基础代码检查
> - **语言支持**：JavaScript、TypeScript、Vue.js 完整支持
> - **代码格式化**：集成 Prettier，统一代码风格
> - **导入管理**：自动排序、路径解析、重复检查
> - **多文件类型**：支持 JSON、Markdown、CSS 等文件检查
> - **项目集成**：完美适配 Vue 3 + TypeScript + Vite 项目架构

### prettier

[Prettier](https://prettier.io/) 是一款强大的代码格式化工具，支持 JavaScript、TypeScript、CSS、SCSS、Less、JSX、Angular、Vue、GraphQL、JSON、Markdown 等语言，基本上前端能用到的文件格式它都可以搞定，是当下最流行的代码格式化工具。

1. 安装：

```bash
npm install prettier -D
```

2. 创建 Prettier 配置文件
   Prettier 支持多种格式的配置文件，比如 .json、.yml、.yaml、.js等。
   在本项目根目录下创建 .prettierrc 文件。

3. 配置
    ```json
    {
    	"useTabs": true,
    	"tabWidth": 4,
    	"printWidth": 150,
    	"singleQuote": true,
    	"trailingComma": "none",
    	"bracketSpacing": true,
    	"semi": false
    }
    ```

注意：vscode 需要安装 prettier 插件：![prettier](./images/prettier.png)

### stylelint

[StyleLint](https://stylelint.io/) 是一个现代的 CSS 代码检查工具，帮助你避免错误并强制执行一致的代码风格。它理解最新的 CSS 语法，包括自定义属性和级联 5 级规范，并且与 CSS 类似的语法（如 SCSS、Sass、Less 和 SugarSS）完全兼容。

#### 1. StyleLint 依赖插件安装与说明：

##### 核心StyleLint包
```bash
# StyleLint 核心包 - 提供CSS/SCSS代码质量检查的核心功能
npm install stylelint -D
```

##### 标准配置包
```bash
# StyleLint 标准配置 - 提供CSS基础规则集
npm install stylelint-config-standard -D

# StyleLint SCSS 标准配置 - 提供SCSS/Sass特定的规则集
npm install stylelint-config-standard-scss -D

# StyleLint Vue 标准配置 - 提供Vue单文件组件中CSS的规则集
npm install stylelint-config-standard-vue -D

# CSS属性排序配置 - 基于Recess顺序的CSS属性自动排序规则
npm install stylelint-config-recess-order -D
```

##### 格式化集成
```bash
# StyleLint Prettier 集成 - 将Prettier格式化规则集成到StyleLint中，统一CSS代码风格
npm install stylelint-prettier -D
```

##### 语法解析器
```bash
# PostCSS HTML 解析器 - 支持在HTML和Vue文件中解析CSS代码
npm install postcss-html -D

# PostCSS SCSS 解析器 - 支持SCSS语法解析和处理
npm install postcss-scss -D
```

##### 一键安装所有依赖
```bash
# 一次性安装所有 StyleLint 相关依赖：
npm install stylelint stylelint-config-standard stylelint-config-standard-scss stylelint-config-standard-vue stylelint-config-recess-order stylelint-prettier postcss-html postcss-scss -D
```

#### 2. StyleLint 配置文件

在项目根目录创建 `.stylelintrc.js` 配置文件：
[stylelintrc](../.stylelintrc.js)

#### 3. Package.json 脚本配置

在 `package.json` 的 `scripts` 部分添加 StyleLint 相关命令：

```json
{
  "scripts": {
    "stylelint": "stylelint \"**/*.{scss,vue,css}\"",
    "stylelint:fix": "stylelint --fix \"**/*.{scss,vue,css}\""
  }
}
```

#### 4. 编辑器插件

vscode 需要安装 stylelint 插件：![stylelint-vscode](./images/stylelint-vscode.png)

在 `.vscode/settings.json` 中添加配置：

```json
{
  "editor.codeActionsOnSave": {
    "source.fixAll.eslint": "explicit",
    "source.fixAll.stylelint": "explicit"
  },
  "editor.insertSpaces": false,

  // 禁用内置的CSS验证器，使用stylelint代替
  "css.validate": false,
  "less.validate": false,
  "scss.validate": false,

  // 指定stylelint校验的文件类型
  "stylelint.validate": ["css", "less", "postcss", "vue", "scss"],

  // 使用prettier作为默认格式化器
  "[vue]": {
    "editor.defaultFormatter": "esbenp.prettier-vscode"
  },
  "[css]": {
    "editor.defaultFormatter": "esbenp.prettier-vscode"
  },
  "[scss]": {
    "editor.defaultFormatter": "esbenp.prettier-vscode"
  }
}
```

#### 5. 使用方式

```bash
# 检查所有样式文件
npm run stylelint

# 自动修复可修复的样式问题
npm run stylelint:fix

# 检查特定文件
npx stylelint "src/**/*.scss"

# 检查并修复特定文件
npx stylelint "src/**/*.vue" --fix
```

> **StyleLint 功能总结：**
> - **代码质量**：检查CSS/SCSS语法错误和潜在问题
> - **代码风格**：统一代码格式和命名规范
> - **属性排序**：自动按照逻辑顺序排列CSS属性
> - **Vue支持**：完美支持Vue单文件组件中的样式检查
> - **SCSS支持**：全面支持SCSS语法和特性
> - **Prettier集成**：与代码格式化工具无缝集成
> - **编辑器集成**：支持实时检查和自动修复


### editorconfig

[EditorConfig](https://editorconfig.org/) 有助于为不同 IDE 编辑器上处理同一项目的多个开发人员维护一致的编码风格。

1. 安装：
   需要配合vscode 的 editorconfig 插件：
   ![editorconfig](./images/editorconfig.png)

2. 创建 EditorConfig 配置文件

    在项目根目录下创建 .editorconfig 文件：

3. 配置

```bash
# Editor configuration, see http://editorconfig.org
# Editor configuration, see https://github.com/editorconfig/editorconfig/wiki/EditorConfig-Properties

# 表示是最顶层的 EditorConfig 配置文件
root = true

[*] # 表示所有文件适用
charset = utf-8 # 设置文件字符集为 utf-8
indent_style = tab # 缩进风格（tab | space）
indent_size = 4 # 缩进大小
end_of_line = lf # 控制换行类型(lf | cr | crlf)
trim_trailing_whitespace = true # 去除行首的任意空白字符
max_line_length = 150

[*.md] # 表示仅 md 文件适用以下规则
max_line_length = off
trim_trailing_whitespace = false
```

## Vue Router

```bash
npm install vue-router@4
```

在 src 目录下创建 router 目录，然后在 router 目录里新建 index.ts 和 modules 目录：

```bash
└── src/
     ├── router/
         ├── index.ts  // 路由配置文件
         ├── modules/  // 路由模块目录
```

如果系统需要做权限控制，可以通过路由守卫来实现，在 router 目录下新建 permission.ts 文件：

```bash
└── src/
     ├── router/
         ├── permission.ts  // 路由守卫文件
```

permission.ts 文件内容：
[permission](../src/router/permission.js)

配合NProgress 实现页面加载进度条：
```bash
npm install nprogress -D
```

## Vuex|pinia 状态管理

## axios 请求配置

## 静态资源配置

## ESLint、prettier、stylelint 代码规范

## npmrc 版本管理

## sass 配置

## tsconfig 配置

## autoImport 自动导入

## compress 压缩

## 项目管理

### 统一方案

### 文件夹结构

## Vite 配置文件

```typescript
import { defineConfig } from 'vite'
import vue from '@vitejs/plugin-vue'
// 如果编辑器提示 path 模块找不到，则可以安装一下 @types/node -> npm i @types/node -D
import { resolve } from 'path'

export default defineConfig({
	plugins: [vue()],
	base: '/',
	resolve: {
		alias: {
			'@': resolve(__dirname, 'src') // 路径别名：设置 `@` 指向 `src` 目录
		}
	},
	server: {
		port: 3333, // 设置服务启动端口号
		open: true, // 设置服务启动时是否自动打开浏览器
		cors: true, // 允许跨域
		// 接口代理，将请求代理到目标环境
		proxy: {
			'/xx-api': {
				target: 'http://xxx.com/xx-api',
				changeOrigin: true,
				rewrite: (path) => path.replace(/^\/xx-api/, '')
			}
		}
	}
})
```

## .vscode 配置

.vscode 目录下创建 extensions.json 文件，用于配置 vscode 的扩展插件：

```json
{
	"recommendations": ["Vue.volar"]
}
```

settings.json 文件，用于配置 vscode 的设置：

```json
{
	"editor.codeActionsOnSave": {
		"source.fixAll.eslint": "explicit",
		"source.fixAll.stylelint": "explicit"
	}
}
```
